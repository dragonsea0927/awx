---
- name: Generate a test ID
  set_fact:
    test_id: "{{ lookup('password', '/dev/null chars=ascii_letters length=16') }}"
  when: test_id is not defined

- name: Generate object names
  set_fact:
    project_name: "AWX-Collection-tests-manual_project-proj-{{ test_id }}"
    project_dir_name: "proj_{{ test_id }}"

- name: Create a project directory for manual project
  import_tasks: create_project_dir.yml

- name: Create a manual project
  project:
    name: "{{ project_name }}"
    organization: Default
    scm_type: manual
    local_path: "{{ project_dir_name }}"
  register: result

- assert:
    that:
      - "result is changed"

- name: Delete a manual project
  project:
    name: "{{ project_name }}"
    organization: Default
    state: absent
  register: result

- assert:
    that:
      - "result is changed"
